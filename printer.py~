import json

from pydantic.dataclasses import dataclass
from tabulate import tabulate


def print_data(data):
    rows = []

    for participant in data:
        name = participant["name"]
        net_amount = participant.get("amount", 0.0)
        actions = participant.get("actions", [])

        if not actions:
            # If no actions, just show participant with empty action
            rows.append([name, net_amount, "", "", ""])
        else:
            # One row per action
            for action in actions:
                rows.append([
                    name,
                    net_amount,
                    action.get("from_", ""),
                    action.get("to", ""),
                    action.get("amount", 0.0)
                ])

    # Print table
    print(tabulate(
        rows,
        headers=["Participant", "Net Amount", "From", "To", "Amount"],
        tablefmt="grid",
        floatfmt=".2f"
    ))


def print_from_file(file_path):
    with open(file_path) as f:
        data = json.load(f)

    print_data(data)

